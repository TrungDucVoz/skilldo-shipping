<?php$Form = new FormBuilder();$Form    ->add('enabled', 'checkbox', [        'label' => 'Bật /Tắt phí ship theo vùng',        'after' => '<div class="col-md-3 form-group">', 'before' => '</div>',    ], (!empty($shipping['enabled'])) ? 'enabled' : '')    ->add('default', 'checkbox', [        'options' => SHIP_KEY,        'label' => 'Phí ship mặc định',        'after' => '<div class="col-md-3 form-group">', 'before' => '</div>',    ], (!empty($shipping['default'])) ? SHIP_KEY : '')    ->add('range_price', 'checkbox', [        'label' => 'Bật /Tắt phí ship theo khoảng giá',        'after' => '<div class="col-md-3 form-group">', 'before' => '</div><div class="clearfix"></div>',    ], (!empty($shipping['range_price'])) ? 'range_price' : 0)    ->add('img', 'image', [        'label' => 'Icon',        'after' => '<div class="col-md-2 form-group">', 'before' => '</div>',    ], $shipping['img'])    ->add('title', 'text', [        'label' => 'Tiêu đề',        'after' => '<div class="col-md-5 form-group">', 'before' => '</div>',    ], $shipping['title'])    ->add('price_default', 'price_default', [        'label' => 'Giá mặc định',        'after' => '<div class="col-md-5 form-group">', 'before' => '</div>',    ], $shipping['price_default']);$Form = apply_filters('admin_payment_'.$key_shipping.'_input_fields', $Form, $shipping);$Form->html(false);?><div class="clearfix"></div><div class="col-md-12">    <h4>KHU VỰC GIAO HÀNG </h4>    <div class="" id="shipping-zone-box">        <table class="table table-bordered" cellspacing="0">            <thead>                <tr>                    <th>Tên Vùng</th>                    <th>Vùng</th>                    <th>Hình thức</th>                    <th></th>                </tr>                <tr class="" id="shipping-zone-add">                    <td><input type="text" class="form-control" value="" name="zone_name"></td>                    <td>                        <select class="form-control zone_locations-multiple" name="zone_locations" multiple>                            <?php $states = Cart_Location::cities();?>                            <?php foreach ($states as $key => $name): ?>                                <option value="<?php echo $key;?>"><?php echo $name;?></option>                            <?php endforeach ?>                        </select>                    </td>                    <td>                        <select class="form-control" name="zone_type">                            <option value="zone_type_free"><?php echo shipping::getZoneType('zone_type_free');?></option>                            <option value="zone_type_flat"><?php echo shipping::getZoneType('zone_type_flat');?></option>                            <option value="zone_type_district"><?php echo shipping::getZoneType('zone_type_district');?></option>                        </select>                    </td>                    <td class="sort text-right">                        <button class="submit btn-green btn-icon" type="button">Thêm</button>                    </td>                </tr>            </thead>            <tbody class="shipping-zone-tbody ui-sortable">            <?php $zones = shipping::getsZone();?>            <?php foreach ($zones as $value): ?>                <tr class="js_shipping_zone__item">                    <td>                        <?php echo $value->zone_name;?>                    </td>                    <td>                        <?php foreach ($value->locations as $location): ?>                            <?php echo $states[$location->location_type];?>                        <?php endforeach ?>                    </td>                    <td>                        <?php echo shipping::getZoneType($value->zone_type);?>                    </td>                    <td class="sort text-right">                        <button class="js_shipping_zone__btn_delete btn-red btn-icon" type="button" data-id="<?php echo $value->id;?>">Xóa</button>                        <a href="<?php echo Url::admin(sicommerce_cart::url('setting').'&tab=shipping&section='.SHIP_KEY.'&zone_id='.$value->id);?>" class="btn-edit btn-blue btn-icon">Edit</a>                    </td>                </tr>            <?php endforeach ?>            </tbody>        </table>    </div></div><style>    table.table tr { border: 1px solid #ccc; }    .action-bar button {display: none;}</style><script type="text/javascript">    $(document).ready(function() {        let zone_box        = $('#shipping-zone-box');        let zone_add        = $('#shipping-zone-add');        let zone_add_label  = '#shipping-zone-add';        let zone_tbody      = $('.shipping-zone-tbody');        $('.zone_locations-multiple').select2();        $(zone_add_label+' button.submit').click(function() {            let data = {                zone_name 		: $(zone_add_label + ' input[name="zone_name"]').val(),                zone_locations 	: $(zone_add_label + ' select[name="zone_locations"]').val(),                zone_type 		: $(zone_add_label + ' select[name="zone_type"]').val(),            };            data.action     =  'admin_shipping_ajax_zone_save';            $.post(ajax, data, function() {}, 'json').done(function(response) {                show_message(response.message, response.status);                if( response.status === 'success' ) {                    zone_tbody.html(response.data);                }            });            return false;        });        $('.js_shipping_zone__btn_delete').click(function() {            let box = $(this).closest('.js_shipping_zone__item');            $(this).text('Đang xóa ...');            let data = {                zone_id  : $(this).attr('data-id')            };            data.action     =  'admin_shipping_ajax_zone_delete';            $.post(ajax, data, function() {}, 'json').done(function( data ) {                show_message(data.message, data.status);                if(data.status === 'success') box.remove();            });            return false;        });    });</script>